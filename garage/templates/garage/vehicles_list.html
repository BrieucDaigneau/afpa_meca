{% extends 'garage/base.html' %}

{% load static %}
{% block head %}
<link href="{% static 'garage/css/style.css' %}" rel="stylesheet" type="text/css" />
{% endblock %}
{% block content %}


<div class="container">
    <div class="row mt-5">
        <h1 class="col-md-5">Liste des Vehicules</h1> 
        
        {% block search %}{% endblock search %}
    </div>


    <div class="row">
        <h4 class="col-md-12" >
            <div class="row">
                <div class=" col-md-3">Modele </div>
                <div class=" col-md-3">Marque</div>
                <div class="col-md-3">N° VIN</div>
                <div class="col-md-3">N° Immatriculation</div>
            </div>
        </h4>
        
        {% for vehicle in vehicle_list %}
        <input type="radio" class="btn col-md-1 radio" id="{{vehicle.id}}" name="VehicleBtn" onclick='javascript:document.vehicleChecked={{vehicle.id}}' >
    </input>
    
    <label for="{{vehicle.id}}" id="listing" class="col-md-12 label_vehicle" ondblclick="redirect()">
        <div class="row ">
            <div class="col-md-3">{{ vehicle.model }}</div>
            <div class="col-md-3">{{ vehicle.brand }}</div>
            <div class="col-md-3">{{ vehicle.vin }}</div>
            <div class="col-md-3">{{ vehicle.license_plate }}</div>
        </div>
        
    </label>
    
    {% empty %}
    <p>aucun véhicule</p>
    {% endfor %}
      
    </div>

<div class="row">
    {% block buttons %}{% endblock buttons %}
</div>

</div>


<script type="text/javascript">
    function redirect() {
        if (window.location.href.indexOf("vehicles") >= 0){
            window.location = "{% url 'garage:vehicle-update' 1 %}".replace(1, document.vehicleChecked)
        }
        else if (window.location.href.indexOf("select") >= 0){
            window.location = "{% url 'garage:reparation-order-create' 1 %}".replace(1, document.vehicleChecked)
        }
    }
    function vehicle_create() { 
//expression régulière qui récupère l'id client
//[/] = recherche le caractère "/" dans l'ulr
//(d+) = "()" retourne la valeur à l'intérieur des (), "d" cherche un nombre entre [0-9],
// "+" cherche entre 1 et plusieurs fois le paramètre saisi avant 
// window.location.href.match(/[/](\d+)[/]/) retourne un tableau = [/nombre/, nombre]
        let stringToFind = window.location.href.match(/[/](\d+)[/]/)
        window.location = "{% url 'garage:vehicle-create' 1 %}".replace(1, stringToFind[1])
        }
    function modifier() {
        window.location = "{% url 'garage:vehicle-update' 1 %}".replace(1, document.vehicleChecked)            
    }
</script> 


{% endblock %}